<h1>Надстройка Navferty Excel Add-In</h1>
<img class="illustration" id="imnav" src="images/NavfertyToolsRibbonRu.png" alt="Пример установки сертификата">

<p>Это страница установки надстройки</p>

<a href="https://github.com/navferty/NavfertyExcelAddIn">Страница проекта на GitHub</a>

<p>Для установки надстройки скачайте и запустите <a href="./setup/setup.exe">установочный файл</a></p>

<p>
    К сожалению, пока не удалось получить доверенный сертификат, поэтому пока для установки необходимо
    установить сертификат следующим образом:
</p>

<img src="./cert-install.png" alt="Пример установки сертификата">

<p>Надеюсь, скоро получится получить нормальный сертификат... =)</p>

<h1>Описание функций</h1>

<h2 class="zag" id="-1">Управление</h2>
<h3 id="-2">Отменить последнее действие</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/undo.png" alt="">
            </td>
            <td>
                Отменить последнее действие, совершённое с помощью данной надстройки. Отмена возможна для некоторых функций в
                разделах 'Преобразование значений' и 'Форматирование значений' и только, если диапазон ячеек не редактировался
                после совершения действия.
            </td>
        </tr>
    </tbody>
</table>
<p><a href="#excel-надстройка-navfertys-tools">Наверх</a></p>
<hr>
<h2 class="zag" id="-3">Преобразование значений</h2>
<h3 id="-4">Парсинг числовых значений</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/parseNumerics.png" alt="">
            </td>
            <td>Преобразование чисел, сохраненных в виде текста, в числовой формат.</td>
        </tr>
    </tbody>
</table>
<p></p>
<details>
    <summary>Посмотреть скриншоты</summary>
    <p></p>
    <p>
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/ParseNumerics1.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/ParseNumerics2.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
    </p>
</details>
<p></p>
<h3 id="-5">Заменить</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/replace.png" alt="">
            </td>
            <td>Замена русских символов по таблицам соответствия.</td>
        </tr>
    </tbody>
</table>
<ul>
    <li>
        <h4 id="-19">Транслитерацией</h4>
        <table>
            <thead>
                <tr>
                    <th style="text-align:left;"></th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="text-align:left;">
                        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/transliterate.png" alt="">
                    </td>
                    <td>
                        Полностью меняется весь русский алфавит на английский. Например, буква "Ж" заменится на "Zh", а буква "Щ"
                        - на "Shch". Основано на документе ИКАО <a href="https://www.icao.int/publications/Documents/9303_p3_cons_ru.pdf">9303</a>.
                    </td>
                </tr>
            </tbody>
        </table>
        <p></p>
        <details>
            <summary>Посмотреть скриншоты</summary>
            <p></p>
            <p>
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/Transliterate1.png"
                     alt="Navferty's Tools Ribbon Tab in MS Excel">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/Transliterate2.png"
                     alt="Navferty's Tools Ribbon Tab in MS Excel">
            </p>
        </details>
        <p></p>
    </li>
    <li>
        <h4 id="-20">На аналоги</h4>
        <table>
            <thead>
                <tr>
                    <th style="text-align:left;"></th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="text-align:left;">
                        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/replaceChars.png" alt="">
                    </td>
                    <td>
                        Заменятся только схожие по верхнему регистру буквы алфавитов, такие как: Аа, Вв, Ее, Кк, Мм, Нн, Оо, Рр,
                        Сс, Тт, Уу, Хх.
                    </td>
                </tr>
            </tbody>
        </table>
        <p></p>
        <details>
            <summary>Посмотреть скриншоты</summary>
            <p></p>
            <p>
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/ReplaceChars1.png"
                     alt="Navferty's Tools Ribbon Tab in MS Excel">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/ReplaceChars2.png"
                     alt="Navferty's Tools Ribbon Tab in MS Excel">
            </p>
        </details>
        <p></p>
    </li>
</ul>
<h3 id="-6">Преобразовать в слова</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/stringifyNumerics.png" alt="">
            </td>
            <td>
                Переписывает числовые значения в текст с расшифровкой<br>- На русском<br>- На английском<br>- На французском
            </td>
        </tr>
    </tbody>
</table>
<p></p>
<details>
    <summary>Посмотреть скриншоты</summary>
    <p></p>
    <p>
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/Stringify1.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/Stringify2.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
    </p>
</details>
<p></p>
<p><a href="#excel-надстройка-navfertys-tools">Наверх</a></p>
<hr>
<h2 class="zag" id="-7">Форматирование значений</h2>
<h3 id="-8">Изменить регистр</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/toggleCase.png" alt="">
            </td>
            <td>
                Переключение регистра для текстовых значений в выделенных ячейках по схеме:<br><code>Абвгд</code> -&gt;
                <code>абвгд</code> -&gt; <code>АБВГД</code>
            </td>
        </tr>
    </tbody>
</table>
<p></p>
<details>
    <summary>Посмотреть скриншоты</summary>
    <p></p>
    <p>
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/ToggleCase1.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/ToggleCase2.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/ToggleCase3.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/ToggleCase4.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
    </p>
</details>
<p></p>
<h3 id="-9">Удалить пробелы</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/trimSpaces.png" alt="">
            </td>
            <td>
                Очистить текстовое содержимое выделенных ячеек от лишних пробелов. Удаляет повторные пробелы и переносы строк,
                а также начальные и конечных пробелы в ячейках, имеющих текстовый формат.
            </td>
        </tr>
    </tbody>
</table>
<p></p>
<details>
    <summary>Посмотреть скриншоты</summary>
    <p></p>
    <p>
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/TrimSpaces1.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/TrimSpaces2.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
    </p>
</details>
<p></p>
<p><a href="#excel-надстройка-navfertys-tools">Наверх</a></p>
<hr>
<h2 class="zag" id="-10">Общие</h2>
<h3 id="-11">Снять защиту с книги и листов</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/unprotectWorkbook.png" alt="">
            </td>
            <td>
                Позволяет снять защиту со всех листов открытой книги, как и защиту всей книги, в отсутствие пароля, а также
                разблокировать VBA проект (при его наличии), на который установлен пароль. Функция не распространяется на
                зашифрованные книги.
            </td>
        </tr>
    </tbody>
</table>
<h3 id="-12">Множественная подсветка дублей</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/highlightDuplicates.png" alt="">
            </td>
            <td>
                Устанавливает цвет ячеек, которые содержат повторяющиеся значения, в выделенном диапазоне. Различные цвета
                соответствуют разным группам дублей.
            </td>
        </tr>
    </tbody>
</table>
<p></p>
<details>
    <summary>Посмотреть скриншот</summary>
    <p></p>
    <p>
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/Duplicates.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
    </p>
</details>
<p></p>
<h3 id="-13">Разъединение ячеек с заполнением</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/unmergeCells.png" alt="">
            </td>
            <td>Отменяет объединение ячеек, с одновременным заполнением разъединенных ячеек исходым значением.</td>
        </tr>
    </tbody>
</table>
<p></p>
<details>
    <summary>Посмотреть скриншоты</summary>
    <p></p>
    <p>
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/Unmerge1.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/Unmerge2.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
    </p>
</details>
<p></p>
<h3 id="-14">Найти все ошибки в выделенном диапазоне</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/findErrors.png" alt="">
            </td>
            <td>
                Поиск всех ячеек в выделенных ячейках, которые содержат ошибки вычислений:<br><br>Виды ошибок в MS
                Excel:<br><code>#Н/Д</code><br><code>#ИМЯ?</code><br><code>#ДЕЛ/0!</code><br><code>#ССЫЛКА!</code><br><code>#ЗНАЧ!</code><br><code>#ЧИСЛО!</code><br><code>#ПУСТО!</code>
            </td>
        </tr>
    </tbody>
</table>
<p></p>
<details>
    <summary>Посмотреть скриншот</summary>
    <p></p>
    <p>
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/FindErrorValues.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
    </p>
</details>
<p></p>
<h3 id="markdown">Копировать в Markdown</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/parseNumerics.png" alt="">
            </td>
            <td>Копировать в буфер обмена выделенный фрагмент как таблица Markdown.</td>
        </tr>
    </tbody>
</table>
<p></p>
<details>
    <summary>Посмотреть скриншот</summary>
    <p></p>
    <p>
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/ExportToMarkdown.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
    </p>
</details>
<p></p>
<h3 id="-15">Валидация значений</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/validation.png" alt="">
            </td>
            <td>
                <p>
                    Проверить значения ячеек в выделенном диапазоне на соответствие определённому формату.<br><br>Поддерживаемые
                    форматы:<br>- Число<br>- Дата<br>- ИНН ФЛ* (12 цифр, с двумя проверочными цифрами)<br>- ИНН ЮЛ* (10 цифр, с
                    одной проверочной цифрой)<br>- Текст для XML (отсутствие символов <code>&lt;</code> и <code>&gt;</code> и иных
                    невалидных для содержимого XML)<br><br>* <em>
                        - Корректность ИНН не гарантирует существование организации или
                        физического лица, которому бы принадлежал этот ИНН
                    </em>
                </p>
            </td>
        </tr>
    </tbody>
</table>
<p></p>
<details>
    <summary>Посмотреть скриншот</summary>
    <p></p>
    <p>
        <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/Validate.png"
             alt="Navferty's Tools Ribbon Tab in MS Excel">
    </p>
</details>
<p></p>
<p><a href="#excel-надстройка-navfertys-tools">Наверх</a></p>
<hr>
<h2 class="zag" id="xml">Работа с XML</h2>
<h3 id="xmlxsd">Создать образец XML (по XSD)</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/createSampleXml.png" alt="">
            </td>
            <td>
                Сгенерировать пример XML-файла по xsd-схеме. Позволяет получить наглядное представление о структуре xml-файла
                при наличии XSD-файла со схемой.
            </td>
        </tr>
    </tbody>
</table>
<p>
    Например, для приведённой ниже схемы
</p>
<details>
    <summary>Образец схемы - sample.xsd</summary>
    <p></p>
    <pre><code class="xml language-xml">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;

&lt;xs:element name="КорневойЭлемент"&gt;
  &lt;xs:complexType&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element name="Заголовок" type="xs:string"/&gt;
      &lt;xs:element name="Адресат"&gt;
        &lt;xs:complexType&gt;
          &lt;xs:sequence&gt;
            &lt;xs:element name="Имя" type="xs:string"/&gt;
            &lt;xs:element name="Адрес" type="xs:string"/&gt;
            &lt;xs:element name="Город" type="xs:string"/&gt;
            &lt;xs:element name="Страна" type="xs:string"/&gt;
          &lt;/xs:sequence&gt;
        &lt;/xs:complexType&gt;
      &lt;/xs:element&gt;
      &lt;xs:element name="Элемент" maxOccurs="3"&gt;
        &lt;xs:complexType&gt;
          &lt;xs:sequence&gt;
            &lt;xs:element name="Название" type="xs:string"/&gt;
            &lt;xs:element name="Описание" type="xs:string" minOccurs="0"/&gt;
            &lt;xs:element name="Количество" type="xs:positiveInteger"/&gt;
            &lt;xs:element name="Цена" type="xs:decimal"/&gt;
          &lt;/xs:sequence&gt;
        &lt;/xs:complexType&gt;
      &lt;/xs:element&gt;
    &lt;/xs:sequence&gt;
    &lt;xs:attribute name="Идентификатор" type="xs:string" use="required"/&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:element&gt;

&lt;/xs:schema&gt;
</code></pre>
    <p></p>
</details>
<p></p>
<p>Будет сформирован такой xml-файл:</p>
<p></p>
<details>
    <summary>Результат генерации - sample.xml</summary>
    <p></p>
    <pre><code class="xml language-xml">&lt;КорневойЭлемент xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Идентификатор="Идентификатор1"&gt;
  &lt;Заголовок&gt;Заголовок1&lt;/Заголовок&gt;
  &lt;Адресат&gt;
    &lt;Имя&gt;Имя1&lt;/Имя&gt;
    &lt;Адрес&gt;Адрес1&lt;/Адрес&gt;
    &lt;Город&gt;Город1&lt;/Город&gt;
    &lt;Страна&gt;Страна1&lt;/Страна&gt;
  &lt;/Адресат&gt;
  &lt;Элемент&gt;
    &lt;Название&gt;Название1&lt;/Название&gt;
    &lt;Описание&gt;Описание1&lt;/Описание&gt;
    &lt;Количество&gt;1&lt;/Количество&gt;
    &lt;Цена&gt;1&lt;/Цена&gt;
  &lt;/Элемент&gt;
  &lt;Элемент&gt;
    &lt;Название&gt;Название2&lt;/Название&gt;
    &lt;Описание&gt;Описание2&lt;/Описание&gt;
    &lt;Количество&gt;79228162514264337593543950335&lt;/Количество&gt;
    &lt;Цена&gt;-79228162514264337593543950335&lt;/Цена&gt;
  &lt;/Элемент&gt;
  &lt;Элемент&gt;
    &lt;Название&gt;Название3&lt;/Название&gt;
    &lt;Описание&gt;Описание3&lt;/Описание&gt;
    &lt;Количество&gt;2&lt;/Количество&gt;
    &lt;Цена&gt;79228162514264337593543950335&lt;/Цена&gt;
  &lt;/Элемент&gt;
&lt;/КорневойЭлемент&gt;
</code></pre>
    <p></p>
</details>
<p></p>
<h3 id="xmlxsd-1">Валидация XML по XSD</h3>
<table>
    <thead>
        <tr>
            <th style="text-align:left;"></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left;">
                <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/icons/validateXml.png" alt="">
            </td>
            <td>
                Проверить соответствие xml-файла на основе XSD-схемы. Список ошибок будет выведен на лист в новой книге MS
                Excel.
            </td>
        </tr>
    </tbody>
</table>
<p>Пример отчёта о проверке:</p>
<table>
    <thead>
        <tr>
            <th>Уровень</th>
            <th>Элемент</th>
            <th>Ошибка</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Error</td>
            <td>Город</td>
            <td>Элемент "Адресат" имеет недопустимый дочерний элемент "Город". Список ожидаемых элементов: "Адрес".</td>
        </tr>
        <tr>
            <td>Error</td>
            <td>Количество</td>
            <td>
                Элемент "Количество" недействителен: значение "-5" недействительно с точки зрения его типа данных
                "http://www.w3.org/2001/XMLSchema:positiveInteger" — Значение "-5" недопустимо мало или недопустимо велико для
                PositiveInteger.
            </td>
        </tr>
        <tr>
            <td>Error</td>
            <td>Цена</td>
            <td>
                Элемент "Цена" недействителен: значение "не число" недействительно с точки зрения его типа данных
                "http://www.w3.org/2001/XMLSchema:decimal" — Строка "не число" не является допустимым значением Decimal.
            </td>
        </tr>
    </tbody>
</table>
<p><a href="#excel-надстройка-navfertys-tools">Наверх</a></p>
<hr>
<h2 class="zag" id="-16">В разработке</h2>
<h3 id="-17">Сократить название организаций</h3>
<p>Позволяет сократить тип организации до аббревиатуры (ООО, ПАО, ОАО и др.).</p>
<p><a href="#excel-надстройка-navfertys-tools">Наверх</a></p>
<hr>
<h2 class="zag" id="-18">Инструкция по установке</h2>
<p>Решение построено в Azure, вы можете скачать установочные файлы оттуда:</p>
<ul>
    <li>
        <p>Посетите https://navferty.visualstudio.com/NavfertyExcelAddIn/_build?definitionId=3</p>
    </li>
    <li>
        <p>Выберите последнюю версию сборки 'NavfertyExcelAddIn - Publish':</p>
        <p>
            <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/Install1.png"
                 alt="Navferty's Tools Ribbon Tab in MS Excel">
        </p>
    </li>
    <li>
        <p>Загрузите опубликованные установочные файлы:</p>
        <p>
            <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/Install2.png"
                 alt="Navferty's Tools Ribbon Tab in MS Excel">
        </p>
    </li>
    <li>
        <p>Извлеките файлы в папку и запустите файл '.vsto':</p>
    </li>
</ul>
<blockquote>
    <p>
        Настоятельно рекомендуется использовать папку рабочего стола - установка обновлений разрешена только из той папки,
        из которой надстройка была установлена в первый раз!
    </p>
</blockquote>
<p>
    <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/Install3.png"
         alt="Navferty's Tools Ribbon Tab in MS Excel">
</p>
<ul>
    <li>
        <p>
            После завершения процесса установки запустите (или перезагрузите) приложение Excel, и вы увидите новую вкладку:
        </p>
        <p>
            <img src="https://github.com/navferty/NavfertyExcelAddIn/raw/master/images/Install4.png"
                 alt="Navferty's Tools Ribbon Tab in MS Excel">
        </p>
    </li>
</ul>
<p><a href="#excel-надстройка-navfertys-tools">Наверх</a></p>
</div>